# ИДЗ-2

Индивидуальное домашнее задание №2 по дисциплине  
«Интеллектуальные информационно-измерительные системы».

## Цель работы

Подготовка обучающего датасета для последующего построения модели
нейронной сети распознавания образов дорожных знаков.

## Постановка задачи

Необходимо сформировать размеченный датасет изображений дорожных знаков
на основе «идеальных» векторных изображений с моделированием искажений,
характерных для реальных условий съёмки.

Требования задания:

- количество классов: **10 дорожных знаков**;
- размер изображения: **30×30 пикселей**;
- объём выборки: **1000 изображений** (по 100 на каждый знак);
- последовательность искажений:
  1. искажение перспективы;
  2. наложение на случайный фон;
  3. добавление шума;
- параметры искажений:
  - перспектива: **10–20 %** (влево или вправо, случайно);
  - фон: **20 случайных изображений**;
  - шум типа «соль и перец» до **10 %**;
- формирование CSV-разметки;
- сохранение до **50 примеров изображений** для отчёта
  (по 5 примеров каждого знака).

## Используемый подход

В качестве исходных данных используются векторные изображения дорожных
знаков в формате SVG. Это позволяет получить «идеальные» изображения,
после чего искусственно смоделировать необходимые искажения.

Для корректного наложения знака на фон применяется PNG-изображение
с альфа-каналом. Альфа-канал используется как маска прозрачности,
что позволяет избежать артефактов по краям знака.

## Реализованные этапы обработки

Обработка каждого изображения выполняется строго в порядке,
заданном техническим заданием:

1. **Конвертация SVG → PNG**
   - преобразование векторных изображений в PNG размером 30×30;
   - контроль размера и наличия альфа-канала.

2. **Искажение перспективы**
   - случайный сдвиг вершин изображения;
   - величина искажения: 10–20 % от ширины;
   - направление выбирается случайно.

3. **Наложение на фон**
   - случайный кроп 30×30 из фонового изображения;
   - наложение PNG через альфа-канал.

4. **Добавление шума**
   - шум типа «соль и перец»;
   - доля зашумлённых пикселей — до 10 %.

5. **Формирование CSV-разметки**
   - для каждого изображения сохраняется имя файла и класс знака.

## Структура проекта

- `ИДЗ-2.py` — основной скрипт генерации датасета;
- `backgrounds/` — 20 фоновых изображений;
- `signs/veselkov/` — 10 SVG-изображений дорожных знаков;
- `signs/veselkov_png/` — PNG-версии знаков 30×30;
- `dataset/`
  - сгенерированные изображения;
  - файл разметки `labels.csv`;
- `report_samples/` — 50 примеров изображений для отчёта.

## Результаты

В результате выполнения работы:

- сформирован датасет из **1000 изображений** размером 30×30 пикселей;
- соблюдена требуемая последовательность искажений;
- реализована CSV-разметка для обучения нейронной сети;
- получены примеры изображений для использования в отчёте.

Полученный датасет соответствует требованиям технического задания
и может быть использован для обучения и тестирования модели
распознавания образов.

## Виртуальное окружение

Для воспроизведения результатов рекомендуется использовать
виртуальное окружение Python.

Создание окружения:

```bash
python -m venv .venv